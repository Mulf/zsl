#include <zatlab/mathematics/interpolation.h>
#include <zsl.h>
#include <gtest/gtest.h>
#include <matplot/matplot.h>

using namespace zsl;

constexpr double EPS = 1e-4;

static bool expect_near(const vector_d &v, const vector_d &w){
	for(size_t i = 0; i < v.size(); i++){
		EXPECT_NEAR(v[i], w[i], EPS);
	}
	return true;
}


TEST(interpolation, interp) {
	auto x = colon(0, pi / 4, 2 * pi);
	auto v = sin(x);
	auto xq = colon(0, pi / 16, 2 * pi);
	auto vq1 = interp1(x, v, xq);
	vector_d vq1_m = {0.0000, 0.1768, 0.3536, 0.5303, 0.7071, 0.7803, 0.8536, 0.9268, 1.0000, 0.9268, 0.8536, 0.7803, 0.7071, 0.5303, 0.3536, 0.1768, 0.0000, -0.1768, -0.3536, -0.5303, -0.7071, -0.7803, -0.8536, -0.9268, -1.0000, -0.9268, -0.8536, -0.7803, -0.7071, -0.5303, -0.3536, -0.1768, -0.0000
	};
	expect_near(vq1, vq1_m);
	{
		/*using namespace matplot;
		plot(x, v, "o");
		hold(on);
		plot(xq, vq1, "-*");
		show();*/
	}
}

TEST(interpolation, cspline) {
	vector_d x = colon(-3.0, 3.0);
	vector_d y = {-1, -1, -1, 0, 1, 1, 1};
	auto xq = colon(-3.0, 0.01, 3.0);
	auto p = cspline(x, y, xq);
	vector_d p_m = {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -0.9998, -0.99921, -0.99823, -0.99686, -0.99513, -0.99302, -0.99054, -0.98771, -0.98453, -0.981, -0.97713, -0.97293, -0.9684, -0.96354, -0.95838, -0.9529, -0.94711, -0.94103, -0.93466, -0.928, -0.92106, -0.91385, -0.90637, -0.89862, -0.89062, -0.88238, -0.87388, -0.86515, -0.85619, -0.847, -0.83759, -0.82797, -0.81814, -0.8081, -0.79787, -0.78746, -0.77685, -0.76607, -0.75512, -0.744, -0.73272, -0.72129, -0.70971, -0.69798, -0.68612, -0.67414, -0.66202, -0.64979, -0.63745, -0.625, -0.61245, -0.59981, -0.58708, -0.57426, -0.56137, -0.54842, -0.53539, -0.52231, -0.50918, -0.496, -0.48278, -0.46953, -0.45625, -0.44294, -0.42963, -0.4163, -0.40296, -0.38963, -0.37631, -0.363, -0.34971, -0.33645, -0.32322, -0.31002, -0.29688, -0.28378, -0.27073, -0.25775, -0.24484, -0.232, -0.21924, -0.20657, -0.19399, -0.1815, -0.16912, -0.15686, -0.1447, -0.13267, -0.12077, -0.109, -0.097371, -0.085888, -0.074557, -0.063384, -0.052375, -0.041536, -0.030873, -0.020392, -0.010099, 0, 0.010099, 0.020392, 0.030873, 0.041536, 0.052375, 0.063384, 0.074557, 0.085888, 0.097371, 0.109, 0.12077, 0.13267, 0.1447, 0.15686, 0.16912, 0.1815, 0.19399, 0.20657, 0.21924, 0.232, 0.24484, 0.25775, 0.27073, 0.28378, 0.29688, 0.31002, 0.32322, 0.33645, 0.34971, 0.363, 0.37631, 0.38963, 0.40296, 0.4163, 0.42963, 0.44294, 0.45625, 0.46953, 0.48278, 0.496, 0.50918, 0.52231, 0.53539, 0.54842, 0.56137, 0.57426, 0.58708, 0.59981, 0.61245, 0.625, 0.63745, 0.64979, 0.66202, 0.67414, 0.68612, 0.69798, 0.70971, 0.72129, 0.73272, 0.744, 0.75512, 0.76607, 0.77685, 0.78746, 0.79787, 0.8081, 0.81814, 0.82797, 0.83759, 0.847, 0.85619, 0.86515, 0.87388, 0.88238, 0.89062, 0.89862, 0.90637, 0.91385, 0.92106, 0.928, 0.93466, 0.94103, 0.94711, 0.9529, 0.95838, 0.96354, 0.9684, 0.97293, 0.97713, 0.981, 0.98453, 0.98771, 0.99054, 0.99302, 0.99513, 0.99686, 0.99823, 0.99921, 0.9998, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
	vector_d s_m = {-1, -0.99507, -0.9903, -0.98567, -0.98118, -0.97684, -0.97265, -0.96859, -0.96467, -0.96089, -0.95725, -0.95374, -0.95037, -0.94713, -0.94401, -0.94103, -0.93818, -0.93545, -0.93284, -0.93036, -0.928, -0.92576, -0.92364, -0.92163, -0.91974, -0.91797, -0.91631, -0.91475, -0.91331, -0.91198, -0.91075, -0.90963, -0.90861, -0.90769, -0.90687, -0.90616, -0.90554, -0.90501, -0.90458, -0.90425, -0.904, -0.90384, -0.90378, -0.9038, -0.9039, -0.90409, -0.90437, -0.90472, -0.90515, -0.90566, -0.90625, -0.90691, -0.90765, -0.90846, -0.90933, -0.91028, -0.9113, -0.91238, -0.91352, -0.91473, -0.916, -0.91733, -0.91872, -0.92016, -0.92166, -0.92322, -0.92483, -0.92648, -0.92819, -0.92995, -0.93175, -0.9336, -0.93549, -0.93742, -0.93939, -0.94141, -0.94346, -0.94554, -0.94766, -0.94982, -0.952, -0.95421, -0.95646, -0.95873, -0.96102, -0.96334, -0.96569, -0.96805, -0.97043, -0.97283, -0.97525, -0.97768, -0.98013, -0.98259, -0.98505, -0.98753, -0.99002, -0.99251, -0.995, -0.9975, -1, -1.0025, -1.005, -1.0075, -1.01, -1.0125, -1.0149, -1.0174, -1.0199, -1.0223, -1.0248, -1.0272, -1.0296, -1.032, -1.0343, -1.0367, -1.039, -1.0413, -1.0435, -1.0458, -1.048, -1.0502, -1.0523, -1.0545, -1.0565, -1.0586, -1.0606, -1.0626, -1.0645, -1.0664, -1.0682, -1.0701, -1.0718, -1.0735, -1.0752, -1.0768, -1.0783, -1.0798, -1.0813, -1.0827, -1.084, -1.0853, -1.0865, -1.0876, -1.0887, -1.0897, -1.0907, -1.0915, -1.0924, -1.0931, -1.0938, -1.0943, -1.0948, -1.0953, -1.0956, -1.0959, -1.0961, -1.0962, -1.0962, -1.0962, -1.096, -1.0958, -1.0954, -1.095, -1.0945, -1.0938, -1.0931, -1.0923, -1.0914, -1.0904, -1.0893, -1.088, -1.0867, -1.0852, -1.0837, -1.082, -1.0803, -1.0784, -1.0764, -1.0742, -1.072, -1.0696, -1.0672, -1.0646, -1.0618, -1.059, -1.056, -1.0529, -1.0496, -1.0463, -1.0427, -1.0391, -1.0353, -1.0314, -1.0274, -1.0232, -1.0188, -1.0143, -1.0097, -1.0049, -1, -0.99493, -0.9897, -0.98433, -0.97882, -0.97316, -0.96735, -0.96141, -0.95533, -0.94911, -0.94275, -0.93626, -0.92963, -0.92287, -0.91599, -0.90897, -0.90182, -0.89455, -0.88716, -0.87964, -0.872, -0.86424, -0.85636, -0.84837, -0.84026, -0.83203, -0.82369, -0.81525, -0.80669, -0.79802, -0.78925, -0.78037, -0.77139, -0.76231, -0.75313, -0.74384, -0.73446, -0.72499, -0.71542, -0.70575, -0.696, -0.68616, -0.67622, -0.6662, -0.6561, -0.64591, -0.63563, -0.62528, -0.61485, -0.60434, -0.59375, -0.58309, -0.57235, -0.56154, -0.55067, -0.53972, -0.5287, -0.51762, -0.50648, -0.49527, -0.484, -0.47267, -0.46128, -0.44984, -0.43834, -0.42678, -0.41517, -0.40352, -0.39181, -0.38005, -0.36825, -0.3564, -0.34451, -0.33258, -0.32061, -0.30859, -0.29654, -0.28446, -0.27234, -0.26018, -0.248, -0.23579, -0.22354, -0.21127, -0.19898, -0.18666, -0.17431, -0.16195, -0.14957, -0.13717, -0.12475, -0.11232, -0.099872, -0.087414, -0.074946, -0.062469, -0.049984, -0.037493, -0.024998, -0.0125, 0, 0.0125, 0.024998, 0.037493, 0.049984, 0.062469, 0.074946, 0.087414, 0.099872, 0.11232, 0.12475, 0.13717, 0.14957, 0.16195, 0.17431, 0.18666, 0.19898, 0.21127, 0.22354, 0.23579, 0.248, 0.26018, 0.27234, 0.28446, 0.29654, 0.30859, 0.32061, 0.33258, 0.34451, 0.3564, 0.36825, 0.38005, 0.39181, 0.40352, 0.41517, 0.42678, 0.43834, 0.44984, 0.46128, 0.47267, 0.484, 0.49527, 0.50648, 0.51762, 0.5287, 0.53972, 0.55067, 0.56154, 0.57235, 0.58309, 0.59375, 0.60434, 0.61485, 0.62528, 0.63563, 0.64591, 0.6561, 0.6662, 0.67622, 0.68616, 0.696, 0.70575, 0.71542, 0.72499, 0.73446, 0.74384, 0.75313, 0.76231, 0.77139, 0.78037, 0.78925, 0.79802, 0.80669, 0.81525, 0.82369, 0.83203, 0.84026, 0.84837, 0.85636, 0.86424, 0.872, 0.87964, 0.88716, 0.89455, 0.90182, 0.90897, 0.91599, 0.92287, 0.92963, 0.93626, 0.94275, 0.94911, 0.95533, 0.96141, 0.96735, 0.97316, 0.97882, 0.98433, 0.9897, 0.99493, 1, 1.0049, 1.0097, 1.0143, 1.0188, 1.0232, 1.0274, 1.0314, 1.0353, 1.0391, 1.0427, 1.0463, 1.0496, 1.0529, 1.056, 1.059, 1.0618, 1.0646, 1.0672, 1.0696, 1.072, 1.0742, 1.0764, 1.0784, 1.0803, 1.082, 1.0837, 1.0852, 1.0867, 1.088, 1.0893, 1.0904, 1.0914, 1.0923, 1.0931, 1.0938, 1.0945, 1.095, 1.0954, 1.0958, 1.096, 1.0962, 1.0962, 1.0962, 1.0961, 1.0959, 1.0956, 1.0953, 1.0948, 1.0943, 1.0938, 1.0931, 1.0924, 1.0915, 1.0907, 1.0897, 1.0887, 1.0876, 1.0865, 1.0853, 1.084, 1.0827, 1.0813, 1.0798, 1.0783, 1.0768, 1.0752, 1.0735, 1.0718, 1.0701, 1.0682, 1.0664, 1.0645, 1.0626, 1.0606, 1.0586, 1.0565, 1.0545, 1.0523, 1.0502, 1.048, 1.0458, 1.0435, 1.0413, 1.039, 1.0367, 1.0343, 1.032, 1.0296, 1.0272, 1.0248, 1.0223, 1.0199, 1.0174, 1.0149, 1.0125, 1.01, 1.0075, 1.005, 1.0025, 1, 0.9975, 0.995, 0.99251, 0.99002, 0.98753, 0.98505, 0.98259, 0.98013, 0.97768, 0.97525, 0.97283, 0.97043, 0.96805, 0.96569, 0.96334, 0.96102, 0.95873, 0.95646, 0.95421, 0.952, 0.94982, 0.94766, 0.94554, 0.94346, 0.94141, 0.93939, 0.93742, 0.93549, 0.9336, 0.93175, 0.92995, 0.92819, 0.92648, 0.92483, 0.92322, 0.92166, 0.92016, 0.91872, 0.91733, 0.916, 0.91473, 0.91352, 0.91238, 0.9113, 0.91028, 0.90933, 0.90846, 0.90765, 0.90691, 0.90625, 0.90566, 0.90515, 0.90472, 0.90437, 0.90409, 0.9039, 0.9038, 0.90378, 0.90384, 0.904, 0.90425, 0.90458, 0.90501, 0.90554, 0.90616, 0.90687, 0.90769, 0.90861, 0.90963, 0.91075, 0.91198, 0.91331, 0.91475, 0.91631, 0.91797, 0.91974, 0.92163, 0.92364, 0.92576, 0.928, 0.93036, 0.93284, 0.93545, 0.93818, 0.94103, 0.94401, 0.94713, 0.95037, 0.95374, 0.95725, 0.96089, 0.96467, 0.96859, 0.97265, 0.97684, 0.98118, 0.98567, 0.9903, 0.99507, 1};
	//expect_near(p, p_m);
	{
		/*using namespace matplot;
		plot(x, y, "o")->display_name("Sample Points");
		hold(on);
		plot(xq, p, "-")->display_name("cspline");
		legend();
		show();*/
	}
}


TEST(interpolation, akima) {
	vector_d x = colon(-3.0, 3.0);
	vector_d y = {-1, -1, -1, 0, 1, 1, 1};
	auto xq = colon(-3.0, 0.01, 3.0);
	auto yp = cspline(x, y, xq);
	auto ya = akima(x, y, xq);
	vector_d p_m = {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -0.9998, -0.99921, -0.99823, -0.99686, -0.99513, -0.99302, -0.99054, -0.98771, -0.98453, -0.981, -0.97713, -0.97293, -0.9684, -0.96354, -0.95838, -0.9529, -0.94711, -0.94103, -0.93466, -0.928, -0.92106, -0.91385, -0.90637, -0.89862, -0.89062, -0.88238, -0.87388, -0.86515, -0.85619, -0.847, -0.83759, -0.82797, -0.81814, -0.8081, -0.79787, -0.78746, -0.77685, -0.76607, -0.75512, -0.744, -0.73272, -0.72129, -0.70971, -0.69798, -0.68612, -0.67414, -0.66202, -0.64979, -0.63745, -0.625, -0.61245, -0.59981, -0.58708, -0.57426, -0.56137, -0.54842, -0.53539, -0.52231, -0.50918, -0.496, -0.48278, -0.46953, -0.45625, -0.44294, -0.42963, -0.4163, -0.40296, -0.38963, -0.37631, -0.363, -0.34971, -0.33645, -0.32322, -0.31002, -0.29688, -0.28378, -0.27073, -0.25775, -0.24484, -0.232, -0.21924, -0.20657, -0.19399, -0.1815, -0.16912, -0.15686, -0.1447, -0.13267, -0.12077, -0.109, -0.097371, -0.085888, -0.074557, -0.063384, -0.052375, -0.041536, -0.030873, -0.020392, -0.010099, 0, 0.010099, 0.020392, 0.030873, 0.041536, 0.052375, 0.063384, 0.074557, 0.085888, 0.097371, 0.109, 0.12077, 0.13267, 0.1447, 0.15686, 0.16912, 0.1815, 0.19399, 0.20657, 0.21924, 0.232, 0.24484, 0.25775, 0.27073, 0.28378, 0.29688, 0.31002, 0.32322, 0.33645, 0.34971, 0.363, 0.37631, 0.38963, 0.40296, 0.4163, 0.42963, 0.44294, 0.45625, 0.46953, 0.48278, 0.496, 0.50918, 0.52231, 0.53539, 0.54842, 0.56137, 0.57426, 0.58708, 0.59981, 0.61245, 0.625, 0.63745, 0.64979, 0.66202, 0.67414, 0.68612, 0.69798, 0.70971, 0.72129, 0.73272, 0.744, 0.75512, 0.76607, 0.77685, 0.78746, 0.79787, 0.8081, 0.81814, 0.82797, 0.83759, 0.847, 0.85619, 0.86515, 0.87388, 0.88238, 0.89062, 0.89862, 0.90637, 0.91385, 0.92106, 0.928, 0.93466, 0.94103, 0.94711, 0.9529, 0.95838, 0.96354, 0.9684, 0.97293, 0.97713, 0.981, 0.98453, 0.98771, 0.99054, 0.99302, 0.99513, 0.99686, 0.99823, 0.99921, 0.9998, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
	vector_d s_m = {-1, -0.99507, -0.9903, -0.98567, -0.98118, -0.97684, -0.97265, -0.96859, -0.96467, -0.96089, -0.95725, -0.95374, -0.95037, -0.94713, -0.94401, -0.94103, -0.93818, -0.93545, -0.93284, -0.93036, -0.928, -0.92576, -0.92364, -0.92163, -0.91974, -0.91797, -0.91631, -0.91475, -0.91331, -0.91198, -0.91075, -0.90963, -0.90861, -0.90769, -0.90687, -0.90616, -0.90554, -0.90501, -0.90458, -0.90425, -0.904, -0.90384, -0.90378, -0.9038, -0.9039, -0.90409, -0.90437, -0.90472, -0.90515, -0.90566, -0.90625, -0.90691, -0.90765, -0.90846, -0.90933, -0.91028, -0.9113, -0.91238, -0.91352, -0.91473, -0.916, -0.91733, -0.91872, -0.92016, -0.92166, -0.92322, -0.92483, -0.92648, -0.92819, -0.92995, -0.93175, -0.9336, -0.93549, -0.93742, -0.93939, -0.94141, -0.94346, -0.94554, -0.94766, -0.94982, -0.952, -0.95421, -0.95646, -0.95873, -0.96102, -0.96334, -0.96569, -0.96805, -0.97043, -0.97283, -0.97525, -0.97768, -0.98013, -0.98259, -0.98505, -0.98753, -0.99002, -0.99251, -0.995, -0.9975, -1, -1.0025, -1.005, -1.0075, -1.01, -1.0125, -1.0149, -1.0174, -1.0199, -1.0223, -1.0248, -1.0272, -1.0296, -1.032, -1.0343, -1.0367, -1.039, -1.0413, -1.0435, -1.0458, -1.048, -1.0502, -1.0523, -1.0545, -1.0565, -1.0586, -1.0606, -1.0626, -1.0645, -1.0664, -1.0682, -1.0701, -1.0718, -1.0735, -1.0752, -1.0768, -1.0783, -1.0798, -1.0813, -1.0827, -1.084, -1.0853, -1.0865, -1.0876, -1.0887, -1.0897, -1.0907, -1.0915, -1.0924, -1.0931, -1.0938, -1.0943, -1.0948, -1.0953, -1.0956, -1.0959, -1.0961, -1.0962, -1.0962, -1.0962, -1.096, -1.0958, -1.0954, -1.095, -1.0945, -1.0938, -1.0931, -1.0923, -1.0914, -1.0904, -1.0893, -1.088, -1.0867, -1.0852, -1.0837, -1.082, -1.0803, -1.0784, -1.0764, -1.0742, -1.072, -1.0696, -1.0672, -1.0646, -1.0618, -1.059, -1.056, -1.0529, -1.0496, -1.0463, -1.0427, -1.0391, -1.0353, -1.0314, -1.0274, -1.0232, -1.0188, -1.0143, -1.0097, -1.0049, -1, -0.99493, -0.9897, -0.98433, -0.97882, -0.97316, -0.96735, -0.96141, -0.95533, -0.94911, -0.94275, -0.93626, -0.92963, -0.92287, -0.91599, -0.90897, -0.90182, -0.89455, -0.88716, -0.87964, -0.872, -0.86424, -0.85636, -0.84837, -0.84026, -0.83203, -0.82369, -0.81525, -0.80669, -0.79802, -0.78925, -0.78037, -0.77139, -0.76231, -0.75313, -0.74384, -0.73446, -0.72499, -0.71542, -0.70575, -0.696, -0.68616, -0.67622, -0.6662, -0.6561, -0.64591, -0.63563, -0.62528, -0.61485, -0.60434, -0.59375, -0.58309, -0.57235, -0.56154, -0.55067, -0.53972, -0.5287, -0.51762, -0.50648, -0.49527, -0.484, -0.47267, -0.46128, -0.44984, -0.43834, -0.42678, -0.41517, -0.40352, -0.39181, -0.38005, -0.36825, -0.3564, -0.34451, -0.33258, -0.32061, -0.30859, -0.29654, -0.28446, -0.27234, -0.26018, -0.248, -0.23579, -0.22354, -0.21127, -0.19898, -0.18666, -0.17431, -0.16195, -0.14957, -0.13717, -0.12475, -0.11232, -0.099872, -0.087414, -0.074946, -0.062469, -0.049984, -0.037493, -0.024998, -0.0125, 0, 0.0125, 0.024998, 0.037493, 0.049984, 0.062469, 0.074946, 0.087414, 0.099872, 0.11232, 0.12475, 0.13717, 0.14957, 0.16195, 0.17431, 0.18666, 0.19898, 0.21127, 0.22354, 0.23579, 0.248, 0.26018, 0.27234, 0.28446, 0.29654, 0.30859, 0.32061, 0.33258, 0.34451, 0.3564, 0.36825, 0.38005, 0.39181, 0.40352, 0.41517, 0.42678, 0.43834, 0.44984, 0.46128, 0.47267, 0.484, 0.49527, 0.50648, 0.51762, 0.5287, 0.53972, 0.55067, 0.56154, 0.57235, 0.58309, 0.59375, 0.60434, 0.61485, 0.62528, 0.63563, 0.64591, 0.6561, 0.6662, 0.67622, 0.68616, 0.696, 0.70575, 0.71542, 0.72499, 0.73446, 0.74384, 0.75313, 0.76231, 0.77139, 0.78037, 0.78925, 0.79802, 0.80669, 0.81525, 0.82369, 0.83203, 0.84026, 0.84837, 0.85636, 0.86424, 0.872, 0.87964, 0.88716, 0.89455, 0.90182, 0.90897, 0.91599, 0.92287, 0.92963, 0.93626, 0.94275, 0.94911, 0.95533, 0.96141, 0.96735, 0.97316, 0.97882, 0.98433, 0.9897, 0.99493, 1, 1.0049, 1.0097, 1.0143, 1.0188, 1.0232, 1.0274, 1.0314, 1.0353, 1.0391, 1.0427, 1.0463, 1.0496, 1.0529, 1.056, 1.059, 1.0618, 1.0646, 1.0672, 1.0696, 1.072, 1.0742, 1.0764, 1.0784, 1.0803, 1.082, 1.0837, 1.0852, 1.0867, 1.088, 1.0893, 1.0904, 1.0914, 1.0923, 1.0931, 1.0938, 1.0945, 1.095, 1.0954, 1.0958, 1.096, 1.0962, 1.0962, 1.0962, 1.0961, 1.0959, 1.0956, 1.0953, 1.0948, 1.0943, 1.0938, 1.0931, 1.0924, 1.0915, 1.0907, 1.0897, 1.0887, 1.0876, 1.0865, 1.0853, 1.084, 1.0827, 1.0813, 1.0798, 1.0783, 1.0768, 1.0752, 1.0735, 1.0718, 1.0701, 1.0682, 1.0664, 1.0645, 1.0626, 1.0606, 1.0586, 1.0565, 1.0545, 1.0523, 1.0502, 1.048, 1.0458, 1.0435, 1.0413, 1.039, 1.0367, 1.0343, 1.032, 1.0296, 1.0272, 1.0248, 1.0223, 1.0199, 1.0174, 1.0149, 1.0125, 1.01, 1.0075, 1.005, 1.0025, 1, 0.9975, 0.995, 0.99251, 0.99002, 0.98753, 0.98505, 0.98259, 0.98013, 0.97768, 0.97525, 0.97283, 0.97043, 0.96805, 0.96569, 0.96334, 0.96102, 0.95873, 0.95646, 0.95421, 0.952, 0.94982, 0.94766, 0.94554, 0.94346, 0.94141, 0.93939, 0.93742, 0.93549, 0.9336, 0.93175, 0.92995, 0.92819, 0.92648, 0.92483, 0.92322, 0.92166, 0.92016, 0.91872, 0.91733, 0.916, 0.91473, 0.91352, 0.91238, 0.9113, 0.91028, 0.90933, 0.90846, 0.90765, 0.90691, 0.90625, 0.90566, 0.90515, 0.90472, 0.90437, 0.90409, 0.9039, 0.9038, 0.90378, 0.90384, 0.904, 0.90425, 0.90458, 0.90501, 0.90554, 0.90616, 0.90687, 0.90769, 0.90861, 0.90963, 0.91075, 0.91198, 0.91331, 0.91475, 0.91631, 0.91797, 0.91974, 0.92163, 0.92364, 0.92576, 0.928, 0.93036, 0.93284, 0.93545, 0.93818, 0.94103, 0.94401, 0.94713, 0.95037, 0.95374, 0.95725, 0.96089, 0.96467, 0.96859, 0.97265, 0.97684, 0.98118, 0.98567, 0.9903, 0.99507, 1};
	//expect_near(p, p_m);
	{
		using namespace matplot;
		plot(x, y, "o")->display_name("Sample Points");
		hold(on);
		plot(xq, yp, "-")->display_name("cspline");
		hold(on);
		plot(xq, ya, "-*")->display_name("akima");
		legend();
		show();
	}
}

